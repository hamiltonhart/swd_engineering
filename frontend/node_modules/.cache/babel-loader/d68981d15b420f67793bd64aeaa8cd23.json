{"ast":null,"code":"import _slicedToArray from\"/Users/georgehart/Documents/WebDev/Work/swd_engineering/swd_engineering/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Redirect,Link,useLocation}from\"react-router-dom\";import{RentalBasicInfo,RentalClients,RentalNotes,RentalButtons,RentalDates,RentalDrives}from\"../components/RentalProjects/Detail\";import{Error}from\"../components/global\";import{Button}from\"@material-ui/core\";import{MainWrapper,PageHeadingWrapper,GridWrapper,SimpleDiv}from\"../styled/containers\";import{PageHeading,PageSubheading}from\"../styled/typography\";import{useQuery,useMutation}from\"@apollo/react-hooks\";import{GET_RENTAL_QUERY,DELETE_RENTAL,HOME_PAGE_QUERY,GET_RENTALS_QUERY}from\"../gql\";var RentalDetailPage=function RentalDetailPage(props){var location=useLocation();// const [rentalId, setRentalId] = useState(\n//   (props.location.state && props.location.state.rentalId) ||\n//     window.location.pathname.slice(9)\n// );\nvar _useState=useState(location.pathname.slice(9)),_useState2=_slicedToArray(_useState,2),rentalId=_useState2[0],setRentalId=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),deleted=_useState4[0],setDeleted=_useState4[1];var _useQuery=useQuery(GET_RENTAL_QUERY,{variables:{id:rentalId}}),data=_useQuery.data,loading=_useQuery.loading,error=_useQuery.error;var _useMutation=useMutation(DELETE_RENTAL),_useMutation2=_slicedToArray(_useMutation,2),deleteRentalProject=_useMutation2[0],deleteError=_useMutation2[1].error;var handleDelete=function handleDelete(e){e.preventDefault();deleteRentalProject({variables:{projectId:rentalId},refetchQueries:[{query:HOME_PAGE_QUERY,variables:{limit:8,reverse:true}},{query:GET_RENTALS_QUERY}],onCompleted:deleteCompleted()});};var deleteCompleted=function deleteCompleted(){setDeleted(!deleted);};useEffect(function(){if(location.pathname.slice(9)!==rentalId){setRentalId(location.pathname.slice(9));}});return React.createElement(MainWrapper,null,deleted&&React.createElement(Redirect,{to:\"/rentals\"}),loading&&React.createElement(\"h1\",null,\"Loading\"),error&&React.createElement(Error,{error:error}),data&&React.createElement(React.Fragment,null,React.createElement(PageHeadingWrapper,null,React.createElement(PageHeading,null,data.rentalProject.title),data.rentalProject.season&&React.createElement(PageSubheading,null,\"Season \",data.rentalProject.season)),React.createElement(GridWrapper,{columns:\"65% 35%\",columnGap:\"30px\"},React.createElement(SimpleDiv,{className:\"hacky-width\",minWidth:\"100%\"},React.createElement(RentalBasicInfo,{project:data.rentalProject,abbreviation:data.rentalProject.abbreviation,room:data.rentalProject.primaryRoom,config:data.rentalProject.channelConfig,driveUser:data.rentalProject.driveUser,drivePass:data.rentalProject.drivePass,msUser:data.rentalProject.msUser,msPass:data.rentalProject.msPass}),React.createElement(RentalClients,{clients:data.rentalProject.rentalClients,setRentalId:setRentalId}),React.createElement(RentalNotes,{notes:data.rentalProject.additionalInfo,projectId:data.rentalProject.id})),React.createElement(SimpleDiv,{gridColumn:\"2/3\",alignSelf:\"start\",width:\"100%\"},React.createElement(RentalButtons,{primaryRoomId:data.rentalProject.primaryRoom&&data.rentalProject.primaryRoom.id,projectId:data.rentalProject.id,filesLink:data.rentalProject.filesLink}),React.createElement(RentalDates,{startDate:data.rentalProject.startDate,mixingCompleteDate:data.rentalProject.mixingCompleteDate,projectCompleteDate:data.rentalProject.projectCompleteDate}),React.createElement(RentalDrives,{totalDrives:data.rentalProject.totalDrives,totalStorage:data.rentalProject.totalStorage,drives:data.rentalProject.rentalDrives})),React.createElement(Button,{color:\"secondary\",variant:\"outlined\",onClick:function onClick(e){return handleDelete(e);}},\"Delete\"),deleteError&&React.createElement(Error,{error:deleteError}))));};export default RentalDetailPage;","map":{"version":3,"sources":["/Users/georgehart/Documents/WebDev/Work/swd_engineering/swd_engineering/frontend/src/pages/RentalDetailPage.js"],"names":["React","useState","useEffect","Redirect","Link","useLocation","RentalBasicInfo","RentalClients","RentalNotes","RentalButtons","RentalDates","RentalDrives","Error","Button","MainWrapper","PageHeadingWrapper","GridWrapper","SimpleDiv","PageHeading","PageSubheading","useQuery","useMutation","GET_RENTAL_QUERY","DELETE_RENTAL","HOME_PAGE_QUERY","GET_RENTALS_QUERY","RentalDetailPage","props","location","pathname","slice","rentalId","setRentalId","deleted","setDeleted","variables","id","data","loading","error","deleteRentalProject","deleteError","handleDelete","e","preventDefault","projectId","refetchQueries","query","limit","reverse","onCompleted","deleteCompleted","rentalProject","title","season","abbreviation","primaryRoom","channelConfig","driveUser","drivePass","msUser","msPass","rentalClients","additionalInfo","filesLink","startDate","mixingCompleteDate","projectCompleteDate","totalDrives","totalStorage","rentalDrives"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Redirect, Link, useLocation } from \"react-router-dom\";\n\nimport {\n  RentalBasicInfo,\n  RentalClients,\n  RentalNotes,\n  RentalButtons,\n  RentalDates,\n  RentalDrives\n} from \"../components/RentalProjects/Detail\";\nimport { Error } from \"../components/global\";\n\nimport { Button } from \"@material-ui/core\";\n\nimport {\n  MainWrapper,\n  PageHeadingWrapper,\n  GridWrapper,\n  SimpleDiv\n} from \"../styled/containers\";\nimport { PageHeading, PageSubheading } from \"../styled/typography\";\n\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport {\n  GET_RENTAL_QUERY,\n  DELETE_RENTAL,\n  HOME_PAGE_QUERY,\n  GET_RENTALS_QUERY\n} from \"../gql\";\n\nconst RentalDetailPage = props => {\n  const location = useLocation();\n  // const [rentalId, setRentalId] = useState(\n  //   (props.location.state && props.location.state.rentalId) ||\n  //     window.location.pathname.slice(9)\n  // );\n  const [rentalId, setRentalId] = useState(location.pathname.slice(9));\n  const [deleted, setDeleted] = useState(false);\n\n  const { data, loading, error } = useQuery(GET_RENTAL_QUERY, {\n    variables: {\n      id: rentalId\n    }\n  });\n\n  const [deleteRentalProject, { error: deleteError }] = useMutation(\n    DELETE_RENTAL\n  );\n\n  const handleDelete = e => {\n    e.preventDefault();\n    deleteRentalProject({\n      variables: { projectId: rentalId },\n      refetchQueries: [\n        { query: HOME_PAGE_QUERY, variables: { limit: 8, reverse: true } },\n        { query: GET_RENTALS_QUERY }\n      ],\n      onCompleted: deleteCompleted()\n    });\n  };\n\n  const deleteCompleted = () => {\n    setDeleted(!deleted);\n  };\n\n  useEffect(() => {\n    if (location.pathname.slice(9) !== rentalId) {\n      setRentalId(location.pathname.slice(9));\n    }\n  });\n\n  return (\n    <MainWrapper>\n      {deleted && <Redirect to=\"/rentals\" />}\n      {loading && <h1>Loading</h1>}\n      {error && <Error error={error} />}\n      {data && (\n        <>\n          <PageHeadingWrapper>\n            <PageHeading>{data.rentalProject.title}</PageHeading>\n            {data.rentalProject.season && (\n              <PageSubheading>\n                Season {data.rentalProject.season}\n              </PageSubheading>\n            )}\n          </PageHeadingWrapper>\n          <GridWrapper columns=\"65% 35%\" columnGap=\"30px\">\n            <SimpleDiv className=\"hacky-width\" minWidth=\"100%\">\n              <RentalBasicInfo\n                project={data.rentalProject}\n                abbreviation={data.rentalProject.abbreviation}\n                room={data.rentalProject.primaryRoom}\n                config={data.rentalProject.channelConfig}\n                driveUser={data.rentalProject.driveUser}\n                drivePass={data.rentalProject.drivePass}\n                msUser={data.rentalProject.msUser}\n                msPass={data.rentalProject.msPass}\n              />\n              <RentalClients\n                clients={data.rentalProject.rentalClients}\n                setRentalId={setRentalId}\n              />\n              <RentalNotes\n                notes={data.rentalProject.additionalInfo}\n                projectId={data.rentalProject.id}\n              />\n            </SimpleDiv>\n            <SimpleDiv gridColumn=\"2/3\" alignSelf=\"start\" width=\"100%\">\n              <RentalButtons\n                primaryRoomId={\n                  data.rentalProject.primaryRoom &&\n                  data.rentalProject.primaryRoom.id\n                }\n                projectId={data.rentalProject.id}\n                filesLink={data.rentalProject.filesLink}\n              />\n              <RentalDates\n                startDate={data.rentalProject.startDate}\n                mixingCompleteDate={data.rentalProject.mixingCompleteDate}\n                projectCompleteDate={data.rentalProject.projectCompleteDate}\n              />\n              <RentalDrives\n                totalDrives={data.rentalProject.totalDrives}\n                totalStorage={data.rentalProject.totalStorage}\n                drives={data.rentalProject.rentalDrives}\n              />\n            </SimpleDiv>\n            <Button\n              color=\"secondary\"\n              variant=\"outlined\"\n              onClick={e => handleDelete(e)}\n            >\n              Delete\n            </Button>\n            {deleteError && <Error error={deleteError} />}\n          </GridWrapper>\n        </>\n      )}\n    </MainWrapper>\n  );\n};\n\nexport default RentalDetailPage;\n"]},"metadata":{},"sourceType":"module"}
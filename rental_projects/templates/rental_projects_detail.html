{% extends "base.html" %}
{% load static %}

{% block titleblock %}{% if project.season %}{{project.title}}: Season {{project.season}}{% else %}{{project.title}}{% endif %}
  
{% endblock titleblock %}

{% block bodyblock %}

<div class="page-top-btns">
    <a class="btn" href="{% url 'rental_projects:rental_projects_list' 'all' %}">All Rentals</a>
    <a class="btn" href="{% url 'rental_projects:rental_projects_create' %}">Add New Rental</a>
</div>

    <div class="page-heading">
        <h1>{{project.title}}</h1>
            {% if project.season %}
                <h3>Season {{project.season}}</h3>
            {% endif %}
    </div> 

    <!-- .page-heading end -->
<div class="color-page-white page-area">
    <p class="section-header">Basic Information</p>
    <div class="page-area-info">
        <p>Abbreviation:</p>
        <p>{{ project.abbreviation}}</p>
        <p>Room:</p>
        {% if project.rental_rooms.all %}
            {% for room in project.rental_rooms.all %}
                <p>{{room.room}}</p>
            {% endfor %}
                
        {% else %}
            <form method="POST">
                {% csrf_token %}
                {{add_room_form}}

                <input type="submit" value="Add">
            </form>
        {% endif %}
        
        <p>Channel Configuration:</p>
        <p>{{project.channel_config}}</p>
    </div>
</div>
    
<div class="color-light-grey page-area">
    <p class="section-header">Clients</p>
    <div class="client-list">
        {% for client in project.rental_clients.all %}
            <div class="client-flex">
                <h2><a href="{% url 'contacts:contacts_detail' client.client.pk %}">{{client.client}}</a></h2>
                <p>{{ client.client_role }}</p>
            </div>
        {% endfor %}
        
            <div class="section-form">
                <form method="POST">
                    {% csrf_token %}
                    {{add_client_form}}

                    <input type="submit" value="Add">
                </form>
        </div>
    </div>
</div>

<div class="color-page-white page-area">
    <p class="section-header">Login Information</p>
    <div class="page-area-info">
        <p>Drive Username:</p>
        <p>{{ project.drive_user}}</p>
        <p>Drive Password:</p>
        <p>{{project.drive_pass}}</p>
        <p>Media Shuttle Username:</p>
        <p>{{project.ms_user}}</p>
        <p>Media Shuttle Password:</p>
        <p>{{project.ms_pass}}</p>
    </div>
</div>

<div class="color-light-grey page-area">
        <p class="section-header">Drives</p>
        <div class="page-area-info">
            {% if project.number_of_systems %}
                
                <h2>{{project.number_of_systems}} drives used.</h2>
            
            {% elif project.rental_drives.all %}
                
                {% for drive in project.rental_drives.all %}
                    <div class="client-flex">
                        <h2><a href="{% url 'harddrives:harddrives_detail' drive.drive.pk %}">{{drive.drive}}</a></h2>
                    </div>
                {% endfor %}

            {% else %}
                    <h2>No Drives Assigned</h2>
            {% endif %}
            
            
            
            
        </div>
            <div class="section-form">
                <form method="POST">
                    {% csrf_token %}
                    {{add_drive_form}}
        
                    <input type="submit" value="Add">
                </form>
            </div>
    </div>
        
<div class="color-page-white page-area">
        <p class="section-header">Notes</p>
        <div class="page-area-info">
                <p>{{ project.additional_info }}</p>
                
            </div>
    </div>

    <div class="color-light-grey page-area">
            <p class="section-header">Dates</p>
            <div class="page-area-info">
                <p>Start Date:</p>
                    {% if project.start_date %}
                        <p>{{ project.start_date|date:'M d Y'}}</p>
                    {% else %}
                        <p>----</p>
                    {% endif %}
                
                <p>Mixing Complete Date:</p>
                    {% if project.mixing_complete_date %}
                        <p>{{project.mixing_complete_date|date:'M d Y'}}</p>
                    {% else %}
                        <p>------</p>
                    {% endif %}
                
                <p>Backup Date:</p>
                    {% if project.project_complete_date %}
                        <p>{{project.project_complete_date|date:'M d Y'}}</p>
                    {% else %}
                        <p>------</p>
                    {% endif %}
            </div>
        </div>

        <div class="color-page-white page-area">
            <p class="section-header">Media Shuttle</p>
            <div class="page-area-info">
                <p><a href="#">Edit MS</a></p>
                <p>Client Name</p>
                <p>Media Shuttle IP</p>
            </div>
        </div>
    


        <div class="page-bottom-btns">

    <form method=POST>  <!-- Needs formatting and isn't working -->
        {% csrf_token %}

        {% if project.mixing_complete_date %}
            <input class="btn" type="submit" value="Incomplete"> 
        {% else %}   
            <input class="btn" type="submit" value="Complete">
        {% endif %}
    </form>
    <a class="btn" href="{% url 'rental_projects:rental_projects_backup' project.pk %}">Backup</a>
    <a class="btn" href="{% url 'rental_projects:rental_projects_update' project.pk %}">Edit</a>
    <a class="btn delete-btn" href="{% url 'rental_projects:rental_projects_delete' project.pk %}">Delete</a>
</div>


{% endblock bodyblock %}